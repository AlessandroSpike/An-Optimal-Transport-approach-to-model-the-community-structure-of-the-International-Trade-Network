# An-Optimal-Transport-approach-to-model-the-community-structure-of-the-International-Trade-Network

This repository contains the implementation of the methodologies and analyses presented in the paper **"An Optimal Transport approach to model the community structure of the International Trade Network"**. The framework integrates **Optimal Transport (OT)** theory with a **gravity-based null model** to analyze the community structure of the International Trade Network (ITN), offering insights into the effects of socio-economic constraints on trade relationships.

## Overview

### Key Features:
- A **gravity model** for estimating trade flows based on economic and geographical factors.
- Use of **Optimal Transport (OT)** to compute modularity and evaluate community structures.
- Comparison of classical modularity methods with OT-based approaches to reveal deeper insights into trade dynamics.
- Scenario analysis for economic shocks, trade disruptions, and policy changes.
- Tools to analyze the evolution of the trade network (2000-2020) and its degree distributions.
- Visualization of trade flows, network properties, and regression results.

### Highlights:
- Empirical results show that the proposed approach aligns with standard modularity methods during stable periods but outperforms them during crises.
- The framework captures the role of **financial development** in shaping community partitions.
- Evaluation metrics include **mutual information** and **variation of information** to compare community structures.

---

## Repository Structure

```
├── Data/  
│   ├── DatiProcessati.mat         # Preprocessed trade data  
│   ├── POISSON_RegressionResults.mat # Regression results for Poisson model  
│   ├── ZIP_RegressionResults.mat  # Regression results for ZIP model  
│   └── DatiGrezzi.mat             # Raw trade data  
├── Scripts/  
│   ├── GravityModelEstimation.m   # Gravity model estimation script  
│   ├── OT_ModularityAnalysis.m    # OT-based modularity analysis script  
│   ├── NetworkEvolutionAnalysis.m # Trade network evolution analysis  
│   ├── RegressionVisualization.m  # Visualization of gravity model results  
│   ├── CorrelationAnalysis.m      # Correlation analysis of regression results  
│   └── DataProcessing.m           # Data processing for gravity models  
├── Results/  
│   ├── GravType_RegressionResults.mat # Output of gravity model analysis  
│   └── Visualizations/           # Plots and figures generated by scripts  
└── README.md                     # Documentation  
```

---

## Requirements

### Software:
- **MATLAB**: The scripts rely on MATLAB for computation and visualization.
- **MATLAB Toolboxes**:
  - Statistics and Machine Learning Toolbox
  - Mapping Toolbox (for geographical visualizations)
  
### Dependencies:
- **R**: Used for Zero-Inflated Poisson (ZIP) and Fixed Effects estimation in some scripts.
- Ensure R scripts are correctly set up for integration with MATLAB.

### Data:
- Preprocessed trade data files (`DatiProcessati.mat`, `DatiGrezzi.mat`) should be available in the `Data` folder.

---

## Scripts and Usage

### 1. Gravity Model Estimation (`GravityModelEstimation.m`)
This script estimates trade flows using various gravity model specifications:
- **OLS**: Ordinary Least Squares
- **Poisson**
- **Zero-Inflated Poisson (ZIP)**
- **Fixed Effects** (with and without binned effects)

**Usage**:
1. Place `DatiProcessati.mat` in the `Data` folder.
2. Set the desired gravity model type (`GravType`).
3. Run the script in MATLAB.

**Outputs**:
- Estimated coefficients for each model.
- Fitted trade matrices and regression results (`[GravType]_RegressionResults.mat`).

---

### 2. Optimal Transport and Modularity Analysis (`OT_ModularityAnalysis.m`)
This script evaluates the community structure of the ITN using OT-based methods and compares them to classical modularity approaches.

**Features**:
- Computes modularity scores for both methods.
- Evaluates community structure differences using **mutual information** and **variation of information**.
- Visualizes modularity, information metrics, and community distributions.

**Usage**:
1. Place `POISSON_RegressionResults.mat` in the `Data` folder.
2. Define entropy regularization parameter (`gamma`).
3. Run the script in MATLAB.

**Outputs**:
- Modularity scores and community partitions.
- Comparison metrics and visualizations.

---

### 3. Trade Network Evolution Analysis (`NetworkEvolutionAnalysis.m`)
This script analyzes the evolution of the ITN from 2000 to 2020, focusing on network properties and degree distributions.

**Features**:
- Computes node/link counts, total flow, and network density.
- Analyzes degree distributions (in-degree, out-degree, in-strength, out-strength).
- Generates geographical visualizations of trade flows.

**Usage**:
1. Place `ZIP_RegressionResults.mat` and `DatiGrezzi.mat` in the `Data` folder.
2. Run the script in MATLAB.

**Outputs**:
- Geographical network visualizations.
- Evolution plots of network properties and degree distributions.

---

### 4. Regression Visualization (`RegressionVisualization.m`)
Visualizes the results of gravity models, showing trends in coefficients and standard errors for key variables (e.g., GDP, distance, population).

**Features**:
- Comparison of multiple models (OLS, ZIP, Fixed Effects).
- Line and bar plots of coefficient trends.
- Tiled layouts for easier comparison.

**Usage**:
1. Place regression result files in the `RegressionResults` folder.
2. Run the script in MATLAB.

**Outputs**:
- Visualizations of coefficient trends and their evolution over time.

---

### 5. Correlation Analysis (`CorrelationAnalysis.m`)
Computes and visualizes the Pearson correlation between results from different regression models (e.g., FIXED vs. ZIP).

**Features**:
- Handles missing values and normalizes data.
- Highlights years with maximum/minimum correlations.

**Usage**:
1. Place regression result files (`FIXED_RegressionResults.mat`, `ZIP_RegressionResults.mat`) in the `RegressionResults` folder.
2. Run the script in MATLAB.

**Outputs**:
- Correlation matrix and time-series plot of correlations.

---

### 6. Data Processing for Gravity Models (`DataProcessing.m`)
Prepares trade-related data for gravity model estimation by extracting and cleaning covariates.

**Features**:
- Processes variables like GDP, population, distance, and trade barriers.
- Filters invalid data and reshapes variables for regression.

**Usage**:
1. Place `DatiProcessati.mat` in the `Data` folder.
2. Set the `GravType` variable (e.g., OLS, Poisson, ZIP).
3. Run the script in MATLAB.

**Outputs**:
- Processed datasets (`[GravType]_SCENARIO_Covariates.mat`).

---

## Outputs
- Regression results (`[GravType]_RegressionResults.mat`).
- Modularity scores and community partitions.
- Visualizations of trade networks, modularity, and regression coefficients.
- Correlation trends between regression models.

---

## Citation
If you use this code in your research, please cite the paper:

*"An Optimal Transport approach to model the community structure of the International Trade Network"*.

---
